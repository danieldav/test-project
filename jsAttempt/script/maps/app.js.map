{"version":3,"sources":["app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","document","getElementById","./helpers","./history","./localstorage","./media","./search",2,3,"pushToHistory","item","createElement","textContent","searchTerm","value","history","children","removeChild","lastElementChild","insertBefore","firstElementChild","updateLocalStorage","addEventListener","target","tagName","innerText","count","getData",4,"setStorage","key","localStorage","setItem","setupStorage","storageItem","recentItems","getItem","main","classList","add","isTileView","innerHTML",5,"artwork","audio","play",6,"request","XMLHttpRequest","requestURL","baseURL","clientID","open","onload","status","data","JSON","parse","responseText","filter","elem","artwork_url","stream_url","console","log","populateResults","onerror","send","resultObj","results","currentResults","resetMedia","enableBtns","title","image","push","resultList","nextBtn","disabled","listViewBtn","tileViewBtn","disableBtns","searchBtn","remove","listItem","closest","index","getIndex","style","display","src","createItemClone"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar helpers = require('./helpers');\nvar localstorage = require('./localstorage');\nvar search = require('./search');\nvar media = require('./media');\nvar history = require('./history');\n\nvar main = document.getElementById('main'),\n    searchBtn = document.getElementById('searchBtn'),\n    searchTerm = document.getElementById('searchInput'),\n    resultList = document.getElementById('results'),\n    nextBtn = document.getElementById('nextBtn'),\n    listViewBtn = document.getElementById('listViewBtn'),\n    tileViewBtn = document.getElementById('tileViewBtn'),\n    artwork = document.getElementById('artwork'),\n    audio = document.getElementById('audio'),\n    history = document.getElementById('history'),\n    baseURL = 'https://api.soundcloud.com/tracks/',\n    clientID = '?client_id=d652006c469530a4a7d6184b18e16c81',\n    data,\n    isTileView,\n    currentResults,\n    count = 0;\n\n},{\"./helpers\":2,\"./history\":3,\"./localstorage\":4,\"./media\":5,\"./search\":6}],2:[function(require,module,exports){\n\"use strict\";\n\n// get nearest parent element matching selector\n// taken from here: http://stackoverflow.com/a/16430350/703717\nfunction closest(el, selector) {\n    var matchesSelector = el.matches || el.webkitMatchesSelector || el.mozMatchesSelector || el.msMatchesSelector;\n\n    while (el) {\n        if (matchesSelector.call(el, selector)) {\n            break;\n        }\n        el = el.parentElement;\n    }\n    return el;\n}\nfunction getIndex(elem) {\n    return Array.prototype.indexOf.call(elem.parentNode.children, elem);\n}\nfunction getCenterCoords(elem) {\n    var clientRect = elem.getBoundingClientRect(),\n        coords = {};\n    coords.x = clientRect.left + clientRect.width / 2;\n    coords.y = clientRect.top + clientRect.height / 2;\n    return coords;\n}\nfunction getComputed(elem, prop) {\n    return getComputedStyle(elem, null).getPropertyValue(prop);\n}\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nfunction pushToHistory() {\n  var item = document.createElement('li');\n  item.textContent = searchTerm.value;\n  if (history.children.length === 5) {\n    history.removeChild(history.lastElementChild);\n  }\n  history.insertBefore(item, history.firstElementChild);\n  updateLocalStorage();\n}\n\nhistory.addEventListener('click', function (e) {\n  if (e.target.tagName === 'LI') {\n    searchTerm.value = e.target.innerText;\n    count = 0;\n    pushToHistory();\n    getData();\n  }\n}, false);\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nfunction setStorage(key, value) {\n  localStorage.setItem(key, value);\n}\nfunction getStorage(key, value) {\n  localStorage.getItem(key, value);\n}\nfunction setupStorage() {\n  var storageItem,\n      recentItems = '';\n  if (!localStorage.getItem('isTileView')) {\n    // no local storage yet - so set it up\n    setStorage('isTileView', 'false');\n    isTileView = false; //list view by default\n  } else {\n      if (localStorage.getItem('isTileView') === 'true') {\n        main.classList.add('tile');\n        isTileView = true;\n      } else {\n        isTileView = false;\n      }\n      for (var i = 0; i < 5; i++) {\n        storageItem = localStorage.getItem('recent' + i);\n        if (storageItem) {\n          recentItems += '<li>' + storageItem;\n        } else {\n          break;\n        }\n      }\n      history.innerHTML = recentItems;\n    }\n}\nfunction updateLocalStorage() {\n  var searches = history.children;\n  for (var i = 0; i < searches.length; i++) {\n    setStorage('recent' + i, searches[i].textContent);\n  }\n}\nsetupStorage();\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nfunction createItemClone(item) {\n  console.log('cloning...', item);\n  var itemClone = item.cloneNode(true);\n  itemClone.classList.add('clone');\n  //console.log(item.getBoundingClientRect().left,item.getBoundingClientRect().top);\n  itemClone.style.left = item.getBoundingClientRect().left + 'px';\n  itemClone.style.top = item.getBoundingClientRect().top + 'px';\n  results.appendChild(itemClone);\n  animateItem(itemClone);\n  artwork.style.display = 'block';\n  showArtwork();\n  removeClone(itemClone);\n}\nfunction removeClone(clone) {\n  setTimeout(function () {\n    results.removeChild(clone);\n  }, 700);\n}\nfunction showArtwork() {\n  setTimeout(function () {\n    artwork.classList.add('show');\n  }, 500);\n}\nfunction animateItem(item) {\n  console.log('moving...', item);\n  setTimeout(function () {\n    var diffX = getCenterCoords(artwork).x - getCenterCoords(item).x;\n    var diffY = getCenterCoords(artwork).y - getCenterCoords(item).y;\n    //console.log(diffX,diffY);\n    item.style.left = parseInt(getComputed(item, 'left'), 10) + diffX + 'px';\n    item.style.top = parseInt(getComputed(item, 'top'), 10) + diffY + 'px';\n    item.style.opacity = 0;\n    //artwork.classList.add('show');\n  }, 0);\n}\nfunction resetMedia() {\n  audio.classList.remove('playing');\n  audio.src = '';\n  artwork.src = '';\n}\n\nartwork.addEventListener('click', function () {\n  audio.play();\n  audio.classList.add('playing');\n}, false);\n\n},{}],6:[function(require,module,exports){\n'use strict';\n\nfunction getData() {\n  var request = new XMLHttpRequest(),\n      requestURL = baseURL + clientID + '&tag_list=' + searchTerm.value;\n  request.open('GET', requestURL, true);\n  request.onload = function () {\n    if (request.status >= 200 && request.status < 400) {\n      // Success!\n      data = JSON.parse(request.responseText).filter(function (elem) {\n        //return elem.artwork_url && elem.stream_url && elem.title.indexOf('at') !== -1;\n        return elem.artwork_url && elem.stream_url;\n      });\n      console.log(data);\n      console.log('no results found : ' + data.length);\n      populateResults();\n    } else {\n      // We reached our target server, but it returned an error\n      console.log('server returned error');\n    }\n  };\n\n  request.onerror = function () {\n    // There was a connection error of some sort\n    console.log('request error');\n  };\n  request.send();\n}\n\nfunction populateResults() {\n  var results = \"\",\n      resultObj;\n  currentResults = [];\n  resetMedia();\n  enableBtns();\n  for (var i = count; i < count + 6; i++) {\n    resultObj = {};\n    results += '<li><figure><img src=\"' + data[i % data.length].artwork_url + '\"><figcaption>' + data[i % data.length].title + '</figcaption></li>';\n    resultObj.image = data[i % data.length].artwork_url;\n    resultObj.audio = data[i % data.length].stream_url;\n    currentResults.push(resultObj);\n  }\n  resultList.innerHTML = results;\n  console.log(currentResults);\n}\n\nfunction enableBtns() {\n  nextBtn.disabled = false;\n  listViewBtn.disabled = false;\n  tileViewBtn.disabled = false;\n}\nfunction disableBtns() {\n  nextBtn.disabled = true;\n  listViewBtn.disabled = true;\n  tileViewBtn.disabled = true;\n}\nsearchBtn.addEventListener('click', function () {\n  count = 0;\n  pushToHistory();\n  getData();\n}, false);\n\nnextBtn.addEventListener('click', function () {\n  count += 6;\n  populateResults();\n}, false);\n\nlistViewBtn.addEventListener('click', function () {\n  console.log('list button clicked');\n  if (isTileView) {\n    isTileView = false;\n    main.classList.remove('tile');\n    setStorage('isTileView', 'false');\n  }\n}, false);\n\ntileViewBtn.addEventListener('click', function () {\n  console.log('tile button clicked');\n  if (!isTileView) {\n    isTileView = true;\n    main.classList.add('tile');\n    setStorage('isTileView', 'true');\n  }\n}, false);\n\nresults.addEventListener('click', function (e) {\n  console.log('event object =', e);\n  var listItem = closest(e.target, 'li');\n  console.log('listItem', listItem);\n  //if(e.target.tagName === 'LI') {\n  var index = getIndex(listItem);\n  console.log(index, currentResults[index]);\n  artwork.classList.remove('show');\n  artwork.style.display = 'none'; // I only want fade-in transition\n  artwork.src = currentResults[index].image;\n  audio.src = currentResults[index].audio + clientID;\n  createItemClone(listItem);\n\n  //}\n}, false);\n\ndisableBtns();\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGpzXFxhcHAuanMiLCJzcmNcXGpzXFxoZWxwZXJzLmpzIiwic3JjXFxqc1xcaGlzdG9yeS5qcyIsInNyY1xcanNcXGxvY2Fsc3RvcmFnZS5qcyIsInNyY1xcanNcXG1lZGlhLmpzIiwic3JjXFxqc1xcc2VhcmNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNDQSxJQUFJLFVBQVUsUUFBUSxXQUFSLENBQVY7QUFDSixJQUFJLGVBQWUsUUFBUSxnQkFBUixDQUFmO0FBQ0osSUFBSSxTQUFTLFFBQVEsVUFBUixDQUFUO0FBQ0osSUFBSSxRQUFRLFFBQVEsU0FBUixDQUFSO0FBQ0osSUFBSSxVQUFVLFFBQVEsV0FBUixDQUFWOztBQUVGLElBQUksT0FBTyxTQUFTLGNBQVQsQ0FBd0IsTUFBeEIsQ0FBUDtJQUNGLFlBQVksU0FBUyxjQUFULENBQXdCLFdBQXhCLENBQVo7SUFDQSxhQUFhLFNBQVMsY0FBVCxDQUF3QixhQUF4QixDQUFiO0lBQ0EsYUFBYSxTQUFTLGNBQVQsQ0FBd0IsU0FBeEIsQ0FBYjtJQUNBLFVBQVUsU0FBUyxjQUFULENBQXdCLFNBQXhCLENBQVY7SUFDQSxjQUFjLFNBQVMsY0FBVCxDQUF3QixhQUF4QixDQUFkO0lBQ0EsY0FBYyxTQUFTLGNBQVQsQ0FBd0IsYUFBeEIsQ0FBZDtJQUNBLFVBQVUsU0FBUyxjQUFULENBQXdCLFNBQXhCLENBQVY7SUFDQSxRQUFRLFNBQVMsY0FBVCxDQUF3QixPQUF4QixDQUFSO0lBQ0EsVUFBVSxTQUFTLGNBQVQsQ0FBd0IsU0FBeEIsQ0FBVjtJQUNBLFVBQVUsb0NBQVY7SUFDQSxXQUFXLDZDQUFYO0lBQ0EsSUFaRjtJQWFFLFVBYkY7SUFjRSxjQWRGO0lBZUUsUUFBUSxDQUFSOzs7Ozs7O0FDcEJKLFNBQVMsT0FBVCxDQUFpQixFQUFqQixFQUFxQixRQUFyQixFQUErQjtBQUMzQixRQUFJLGtCQUFrQixHQUFHLE9BQUgsSUFBYyxHQUFHLHFCQUFILElBQTRCLEdBQUcsa0JBQUgsSUFBeUIsR0FBRyxpQkFBSCxDQUQ5RDs7QUFHM0IsV0FBTyxFQUFQLEVBQVc7QUFDUCxZQUFJLGdCQUFnQixJQUFoQixDQUFxQixFQUFyQixFQUF5QixRQUF6QixDQUFKLEVBQXdDO0FBQ3BDLGtCQURvQztTQUF4QztBQUdBLGFBQUssR0FBRyxhQUFILENBSkU7S0FBWDtBQU1BLFdBQU8sRUFBUCxDQVQyQjtDQUEvQjtBQVdBLFNBQVMsUUFBVCxDQUFrQixJQUFsQixFQUF1QjtBQUNyQixXQUFPLE1BQU0sU0FBTixDQUFnQixPQUFoQixDQUF3QixJQUF4QixDQUE2QixLQUFLLFVBQUwsQ0FBZ0IsUUFBaEIsRUFBMEIsSUFBdkQsQ0FBUCxDQURxQjtDQUF2QjtBQUdBLFNBQVMsZUFBVCxDQUF5QixJQUF6QixFQUErQjtBQUM3QixRQUFJLGFBQWEsS0FBSyxxQkFBTCxFQUFiO1FBQ0EsU0FBUyxFQUFULENBRnlCO0FBRzdCLFdBQU8sQ0FBUCxHQUFXLFdBQVcsSUFBWCxHQUFrQixXQUFXLEtBQVgsR0FBbUIsQ0FBbkIsQ0FIQTtBQUk3QixXQUFPLENBQVAsR0FBVyxXQUFXLEdBQVgsR0FBaUIsV0FBVyxNQUFYLEdBQW9CLENBQXBCLENBSkM7QUFLN0IsV0FBTyxNQUFQLENBTDZCO0NBQS9CO0FBT0EsU0FBUyxXQUFULENBQXFCLElBQXJCLEVBQTBCLElBQTFCLEVBQWdDO0FBQzlCLFdBQU8saUJBQWlCLElBQWpCLEVBQXNCLElBQXRCLEVBQTRCLGdCQUE1QixDQUE2QyxJQUE3QyxDQUFQLENBRDhCO0NBQWhDOzs7OztBQ3ZCQSxTQUFTLGFBQVQsR0FBeUI7QUFDdkIsTUFBSSxPQUFPLFNBQVMsYUFBVCxDQUF1QixJQUF2QixDQUFQLENBRG1CO0FBRXZCLE9BQUssV0FBTCxHQUFtQixXQUFXLEtBQVgsQ0FGSTtBQUd2QixNQUFHLFFBQVEsUUFBUixDQUFpQixNQUFqQixLQUE0QixDQUE1QixFQUErQjtBQUNoQyxZQUFRLFdBQVIsQ0FBb0IsUUFBUSxnQkFBUixDQUFwQixDQURnQztHQUFsQztBQUdBLFVBQVEsWUFBUixDQUFxQixJQUFyQixFQUEwQixRQUFRLGlCQUFSLENBQTFCLENBTnVCO0FBT3ZCLHVCQVB1QjtDQUF6Qjs7QUFVQSxRQUFRLGdCQUFSLENBQXlCLE9BQXpCLEVBQWtDLFVBQVMsQ0FBVCxFQUFZO0FBQzVDLE1BQUcsRUFBRSxNQUFGLENBQVMsT0FBVCxLQUFxQixJQUFyQixFQUEyQjtBQUM1QixlQUFXLEtBQVgsR0FBbUIsRUFBRSxNQUFGLENBQVMsU0FBVCxDQURTO0FBRTVCLFlBQVEsQ0FBUixDQUY0QjtBQUc1QixvQkFINEI7QUFJNUIsY0FKNEI7R0FBOUI7Q0FEZ0MsRUFPL0IsS0FQSDs7Ozs7QUNWQSxTQUFTLFVBQVQsQ0FBb0IsR0FBcEIsRUFBd0IsS0FBeEIsRUFBK0I7QUFDN0IsZUFBYSxPQUFiLENBQXFCLEdBQXJCLEVBQTBCLEtBQTFCLEVBRDZCO0NBQS9CO0FBR0EsU0FBUyxVQUFULENBQW9CLEdBQXBCLEVBQXdCLEtBQXhCLEVBQStCO0FBQzdCLGVBQWEsT0FBYixDQUFxQixHQUFyQixFQUEwQixLQUExQixFQUQ2QjtDQUEvQjtBQUdBLFNBQVMsWUFBVCxHQUF3QjtBQUN0QixNQUFJLFdBQUo7TUFBaUIsY0FBYyxFQUFkLENBREs7QUFFdEIsTUFBRyxDQUFDLGFBQWEsT0FBYixDQUFxQixZQUFyQixDQUFELEVBQXFDOztBQUV0QyxlQUFXLFlBQVgsRUFBd0IsT0FBeEIsRUFGc0M7QUFHdEMsaUJBQWEsS0FBYjtBQUhzQyxHQUF4QyxNQUtLO0FBQ0gsVUFBRyxhQUFhLE9BQWIsQ0FBcUIsWUFBckIsTUFBdUMsTUFBdkMsRUFBK0M7QUFDaEQsYUFBSyxTQUFMLENBQWUsR0FBZixDQUFtQixNQUFuQixFQURnRDtBQUVoRCxxQkFBYSxJQUFiLENBRmdEO09BQWxELE1BSUs7QUFDSCxxQkFBYSxLQUFiLENBREc7T0FKTDtBQU9BLFdBQUksSUFBSSxJQUFFLENBQUYsRUFBSSxJQUFFLENBQUYsRUFBSSxHQUFoQixFQUFxQjtBQUNuQixzQkFBYyxhQUFhLE9BQWIsQ0FBcUIsV0FBVyxDQUFYLENBQW5DLENBRG1CO0FBRW5CLFlBQUcsV0FBSCxFQUFnQjtBQUNkLHlCQUFlLFNBQVMsV0FBVCxDQUREO1NBQWhCLE1BR0s7QUFBRSxnQkFBRjtTQUhMO09BRkY7QUFPQSxjQUFRLFNBQVIsR0FBb0IsV0FBcEIsQ0FmRztLQUxMO0NBRkY7QUF5QkEsU0FBUyxrQkFBVCxHQUE4QjtBQUM1QixNQUFJLFdBQVcsUUFBUSxRQUFSLENBRGE7QUFFNUIsT0FBSSxJQUFJLElBQUUsQ0FBRixFQUFJLElBQUUsU0FBUyxNQUFULEVBQWdCLEdBQTlCLEVBQW1DO0FBQ2pDLGVBQVcsV0FBVyxDQUFYLEVBQWEsU0FBUyxDQUFULEVBQVksV0FBWixDQUF4QixDQURpQztHQUFuQztDQUZGO0FBTUE7Ozs7O0FDckNBLFNBQVMsZUFBVCxDQUF5QixJQUF6QixFQUErQjtBQUM3QixVQUFRLEdBQVIsQ0FBWSxZQUFaLEVBQXlCLElBQXpCLEVBRDZCO0FBRTdCLE1BQUksWUFBWSxLQUFLLFNBQUwsQ0FBZSxJQUFmLENBQVosQ0FGeUI7QUFHN0IsWUFBVSxTQUFWLENBQW9CLEdBQXBCLENBQXdCLE9BQXhCOztBQUg2QixXQUs3QixDQUFVLEtBQVYsQ0FBZ0IsSUFBaEIsR0FBdUIsS0FBSyxxQkFBTCxHQUE2QixJQUE3QixHQUFvQyxJQUFwQyxDQUxNO0FBTTdCLFlBQVUsS0FBVixDQUFnQixHQUFoQixHQUFzQixLQUFLLHFCQUFMLEdBQTZCLEdBQTdCLEdBQW1DLElBQW5DLENBTk87QUFPN0IsVUFBUSxXQUFSLENBQW9CLFNBQXBCLEVBUDZCO0FBUTdCLGNBQVksU0FBWixFQVI2QjtBQVM3QixVQUFRLEtBQVIsQ0FBYyxPQUFkLEdBQXdCLE9BQXhCLENBVDZCO0FBVTdCLGdCQVY2QjtBQVc3QixjQUFZLFNBQVosRUFYNkI7Q0FBL0I7QUFhQSxTQUFTLFdBQVQsQ0FBcUIsS0FBckIsRUFBNEI7QUFDMUIsYUFBVyxZQUFXO0FBQ3BCLFlBQVEsV0FBUixDQUFvQixLQUFwQixFQURvQjtHQUFYLEVBRVIsR0FGSCxFQUQwQjtDQUE1QjtBQUtBLFNBQVMsV0FBVCxHQUF1QjtBQUNyQixhQUFXLFlBQVc7QUFDcEIsWUFBUSxTQUFSLENBQWtCLEdBQWxCLENBQXNCLE1BQXRCLEVBRG9CO0dBQVgsRUFFUixHQUZILEVBRHFCO0NBQXZCO0FBS0EsU0FBUyxXQUFULENBQXFCLElBQXJCLEVBQTJCO0FBQ3pCLFVBQVEsR0FBUixDQUFZLFdBQVosRUFBd0IsSUFBeEIsRUFEeUI7QUFFekIsYUFBVyxZQUFXO0FBQ3BCLFFBQUksUUFBUSxnQkFBZ0IsT0FBaEIsRUFBeUIsQ0FBekIsR0FBNkIsZ0JBQWdCLElBQWhCLEVBQXNCLENBQXRCLENBRHJCO0FBRXBCLFFBQUksUUFBUSxnQkFBZ0IsT0FBaEIsRUFBeUIsQ0FBekIsR0FBNkIsZ0JBQWdCLElBQWhCLEVBQXNCLENBQXRCOztBQUZyQixRQUlwQixDQUFLLEtBQUwsQ0FBVyxJQUFYLEdBQWtCLFNBQVMsWUFBWSxJQUFaLEVBQWlCLE1BQWpCLENBQVQsRUFBbUMsRUFBbkMsSUFBeUMsS0FBekMsR0FBaUQsSUFBakQsQ0FKRTtBQUtwQixTQUFLLEtBQUwsQ0FBVyxHQUFYLEdBQWlCLFNBQVMsWUFBWSxJQUFaLEVBQWlCLEtBQWpCLENBQVQsRUFBa0MsRUFBbEMsSUFBd0MsS0FBeEMsR0FBZ0QsSUFBaEQsQ0FMRztBQU1wQixTQUFLLEtBQUwsQ0FBVyxPQUFYLEdBQXFCLENBQXJCOztBQU5vQixHQUFYLEVBUVIsQ0FSSCxFQUZ5QjtDQUEzQjtBQVlBLFNBQVMsVUFBVCxHQUFzQjtBQUNwQixRQUFNLFNBQU4sQ0FBZ0IsTUFBaEIsQ0FBdUIsU0FBdkIsRUFEb0I7QUFFcEIsUUFBTSxHQUFOLEdBQVksRUFBWixDQUZvQjtBQUdwQixVQUFRLEdBQVIsR0FBYyxFQUFkLENBSG9CO0NBQXRCOztBQU1BLFFBQVEsZ0JBQVIsQ0FBeUIsT0FBekIsRUFBa0MsWUFBVztBQUMzQyxRQUFNLElBQU4sR0FEMkM7QUFFM0MsUUFBTSxTQUFOLENBQWdCLEdBQWhCLENBQW9CLFNBQXBCLEVBRjJDO0NBQVgsRUFHL0IsS0FISDs7Ozs7QUN6Q0EsU0FBUyxPQUFULEdBQW1CO0FBQ2pCLE1BQUksVUFBVSxJQUFJLGNBQUosRUFBVjtNQUNKLGFBQWEsVUFBVSxRQUFWLEdBQXFCLFlBQXJCLEdBQW9DLFdBQVcsS0FBWCxDQUZoQztBQUdqQixVQUFRLElBQVIsQ0FBYSxLQUFiLEVBQW9CLFVBQXBCLEVBQWdDLElBQWhDLEVBSGlCO0FBSWpCLFVBQVEsTUFBUixHQUFpQixZQUFXO0FBQzFCLFFBQUksUUFBUSxNQUFSLElBQWtCLEdBQWxCLElBQXlCLFFBQVEsTUFBUixHQUFpQixHQUFqQixFQUFzQjs7QUFFakQsYUFBTyxLQUFLLEtBQUwsQ0FBVyxRQUFRLFlBQVIsQ0FBWCxDQUFpQyxNQUFqQyxDQUNMLFVBQVMsSUFBVCxFQUFlOztBQUViLGVBQU8sS0FBSyxXQUFMLElBQW9CLEtBQUssVUFBTCxDQUZkO09BQWYsQ0FERixDQUZpRDtBQVFqRCxjQUFRLEdBQVIsQ0FBWSxJQUFaLEVBUmlEO0FBU2pELGNBQVEsR0FBUixDQUFZLHdCQUF1QixLQUFLLE1BQUwsQ0FBbkMsQ0FUaUQ7QUFVakQsd0JBVmlEO0tBQW5ELE1BV087O0FBRUwsY0FBUSxHQUFSLENBQVksdUJBQVosRUFGSztLQVhQO0dBRGUsQ0FKQTs7QUFzQmpCLFVBQVEsT0FBUixHQUFrQixZQUFXOztBQUUzQixZQUFRLEdBQVIsQ0FBWSxlQUFaLEVBRjJCO0dBQVgsQ0F0QkQ7QUEwQmpCLFVBQVEsSUFBUixHQTFCaUI7Q0FBbkI7O0FBNkJBLFNBQVMsZUFBVCxHQUEyQjtBQUN6QixNQUFJLFVBQVUsRUFBVjtNQUFjLFNBQWxCLENBRHlCO0FBRXpCLG1CQUFpQixFQUFqQixDQUZ5QjtBQUd6QixlQUh5QjtBQUl6QixlQUp5QjtBQUt6QixPQUFJLElBQUksSUFBRSxLQUFGLEVBQVEsSUFBRSxRQUFNLENBQU4sRUFBUSxHQUExQixFQUErQjtBQUM3QixnQkFBWSxFQUFaLENBRDZCO0FBRTdCLGVBQVcsMkJBQ1QsS0FBSyxJQUFJLEtBQUssTUFBTCxDQUFULENBQXNCLFdBQXRCLEdBQ0EsZ0JBRlMsR0FHVCxLQUFLLElBQUksS0FBSyxNQUFMLENBQVQsQ0FBc0IsS0FBdEIsR0FDQSxvQkFKUyxDQUZrQjtBQU83QixjQUFVLEtBQVYsR0FBa0IsS0FBSyxJQUFJLEtBQUssTUFBTCxDQUFULENBQXNCLFdBQXRCLENBUFc7QUFRN0IsY0FBVSxLQUFWLEdBQWtCLEtBQUssSUFBSSxLQUFLLE1BQUwsQ0FBVCxDQUFzQixVQUF0QixDQVJXO0FBUzdCLG1CQUFlLElBQWYsQ0FBb0IsU0FBcEIsRUFUNkI7R0FBL0I7QUFXQSxhQUFXLFNBQVgsR0FBdUIsT0FBdkIsQ0FoQnlCO0FBaUJ6QixVQUFRLEdBQVIsQ0FBWSxjQUFaLEVBakJ5QjtDQUEzQjs7QUFvQkEsU0FBUyxVQUFULEdBQXNCO0FBQ3BCLFVBQVEsUUFBUixHQUFtQixLQUFuQixDQURvQjtBQUVwQixjQUFZLFFBQVosR0FBdUIsS0FBdkIsQ0FGb0I7QUFHcEIsY0FBWSxRQUFaLEdBQXVCLEtBQXZCLENBSG9CO0NBQXRCO0FBS0EsU0FBUyxXQUFULEdBQXVCO0FBQ3JCLFVBQVEsUUFBUixHQUFtQixJQUFuQixDQURxQjtBQUVyQixjQUFZLFFBQVosR0FBdUIsSUFBdkIsQ0FGcUI7QUFHckIsY0FBWSxRQUFaLEdBQXVCLElBQXZCLENBSHFCO0NBQXZCO0FBS0EsVUFBVSxnQkFBVixDQUEyQixPQUEzQixFQUFvQyxZQUFXO0FBQzdDLFVBQVEsQ0FBUixDQUQ2QztBQUU3QyxrQkFGNkM7QUFHN0MsWUFINkM7Q0FBWCxFQUlqQyxLQUpIOztBQU1BLFFBQVEsZ0JBQVIsQ0FBeUIsT0FBekIsRUFBa0MsWUFBVztBQUMzQyxXQUFTLENBQVQsQ0FEMkM7QUFFM0Msb0JBRjJDO0NBQVgsRUFHL0IsS0FISDs7QUFLQSxZQUFZLGdCQUFaLENBQTZCLE9BQTdCLEVBQXNDLFlBQVc7QUFDL0MsVUFBUSxHQUFSLENBQVkscUJBQVosRUFEK0M7QUFFN0MsTUFBRyxVQUFILEVBQWU7QUFDYixpQkFBYSxLQUFiLENBRGE7QUFFYixTQUFLLFNBQUwsQ0FBZSxNQUFmLENBQXNCLE1BQXRCLEVBRmE7QUFHYixlQUFXLFlBQVgsRUFBd0IsT0FBeEIsRUFIYTtHQUFmO0NBRmtDLEVBT25DLEtBUEg7O0FBU0EsWUFBWSxnQkFBWixDQUE2QixPQUE3QixFQUFzQyxZQUFXO0FBQy9DLFVBQVEsR0FBUixDQUFZLHFCQUFaLEVBRCtDO0FBRS9DLE1BQUcsQ0FBQyxVQUFELEVBQWE7QUFDZCxpQkFBYSxJQUFiLENBRGM7QUFFZCxTQUFLLFNBQUwsQ0FBZSxHQUFmLENBQW1CLE1BQW5CLEVBRmM7QUFHZCxlQUFXLFlBQVgsRUFBd0IsTUFBeEIsRUFIYztHQUFoQjtDQUZvQyxFQU9uQyxLQVBIOztBQVNBLFFBQVEsZ0JBQVIsQ0FBeUIsT0FBekIsRUFBa0MsVUFBUyxDQUFULEVBQVk7QUFDNUMsVUFBUSxHQUFSLENBQVksZ0JBQVosRUFBNkIsQ0FBN0IsRUFENEM7QUFFNUMsTUFBSSxXQUFXLFFBQVEsRUFBRSxNQUFGLEVBQVUsSUFBbEIsQ0FBWCxDQUZ3QztBQUc1QyxVQUFRLEdBQVIsQ0FBWSxVQUFaLEVBQXVCLFFBQXZCOztBQUg0QyxNQUt0QyxRQUFRLFNBQVMsUUFBVCxDQUFSLENBTHNDO0FBTTFDLFVBQVEsR0FBUixDQUFZLEtBQVosRUFBa0IsZUFBZSxLQUFmLENBQWxCLEVBTjBDO0FBTzFDLFVBQVEsU0FBUixDQUFrQixNQUFsQixDQUF5QixNQUF6QixFQVAwQztBQVExQyxVQUFRLEtBQVIsQ0FBYyxPQUFkLEdBQXdCLE1BQXhCO0FBUjBDLFNBUzFDLENBQVEsR0FBUixHQUFjLGVBQWUsS0FBZixFQUFzQixLQUF0QixDQVQ0QjtBQVUxQyxRQUFNLEdBQU4sR0FBWSxlQUFlLEtBQWYsRUFBc0IsS0FBdEIsR0FBOEIsUUFBOUIsQ0FWOEI7QUFXMUMsa0JBQWdCLFFBQWhCOzs7QUFYMEMsQ0FBWixFQWMvQixLQWRIOztBQWdCQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcclxudmFyIGhlbHBlcnMgPSByZXF1aXJlKCcuL2hlbHBlcnMnKTtcclxudmFyIGxvY2Fsc3RvcmFnZSA9IHJlcXVpcmUoJy4vbG9jYWxzdG9yYWdlJyk7XHJcbnZhciBzZWFyY2ggPSByZXF1aXJlKCcuL3NlYXJjaCcpO1xyXG52YXIgbWVkaWEgPSByZXF1aXJlKCcuL21lZGlhJyk7XHJcbnZhciBoaXN0b3J5ID0gcmVxdWlyZSgnLi9oaXN0b3J5Jyk7XHJcblxyXG4gIHZhciBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKSxcclxuICAgIHNlYXJjaEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hCdG4nKSxcclxuICAgIHNlYXJjaFRlcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoSW5wdXQnKSxcclxuICAgIHJlc3VsdExpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0cycpLFxyXG4gICAgbmV4dEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXh0QnRuJyksXHJcbiAgICBsaXN0Vmlld0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaXN0Vmlld0J0bicpLFxyXG4gICAgdGlsZVZpZXdCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGlsZVZpZXdCdG4nKSxcclxuICAgIGFydHdvcmsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXJ0d29yaycpLFxyXG4gICAgYXVkaW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXVkaW8nKSxcclxuICAgIGhpc3RvcnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGlzdG9yeScpLFxyXG4gICAgYmFzZVVSTCA9ICdodHRwczovL2FwaS5zb3VuZGNsb3VkLmNvbS90cmFja3MvJyxcclxuICAgIGNsaWVudElEID0gJz9jbGllbnRfaWQ9ZDY1MjAwNmM0Njk1MzBhNGE3ZDYxODRiMThlMTZjODEnLFxyXG4gICAgZGF0YSxcclxuICAgIGlzVGlsZVZpZXcsXHJcbiAgICBjdXJyZW50UmVzdWx0cyxcclxuICAgIGNvdW50ID0gMDtcclxuIiwiLy8gZ2V0IG5lYXJlc3QgcGFyZW50IGVsZW1lbnQgbWF0Y2hpbmcgc2VsZWN0b3JcclxuLy8gdGFrZW4gZnJvbSBoZXJlOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQzMDM1MC83MDM3MTdcclxuZnVuY3Rpb24gY2xvc2VzdChlbCwgc2VsZWN0b3IpIHtcclxuICAgIHZhciBtYXRjaGVzU2VsZWN0b3IgPSBlbC5tYXRjaGVzIHx8IGVsLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBlbC5tb3pNYXRjaGVzU2VsZWN0b3IgfHwgZWwubXNNYXRjaGVzU2VsZWN0b3I7XHJcblxyXG4gICAgd2hpbGUgKGVsKSB7XHJcbiAgICAgICAgaWYgKG1hdGNoZXNTZWxlY3Rvci5jYWxsKGVsLCBzZWxlY3RvcikpIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsID0gZWwucGFyZW50RWxlbWVudDtcclxuICAgIH1cclxuICAgIHJldHVybiBlbDtcclxufVxyXG5mdW5jdGlvbiBnZXRJbmRleChlbGVtKXtcclxuICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChlbGVtLnBhcmVudE5vZGUuY2hpbGRyZW4sIGVsZW0pO1xyXG59XHJcbmZ1bmN0aW9uIGdldENlbnRlckNvb3JkcyhlbGVtKSB7XHJcbiAgdmFyIGNsaWVudFJlY3QgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICBjb29yZHMgPSB7fTtcclxuICBjb29yZHMueCA9IGNsaWVudFJlY3QubGVmdCArIGNsaWVudFJlY3Qud2lkdGggLyAyO1xyXG4gIGNvb3Jkcy55ID0gY2xpZW50UmVjdC50b3AgKyBjbGllbnRSZWN0LmhlaWdodCAvIDI7XHJcbiAgcmV0dXJuIGNvb3JkcztcclxufVxyXG5mdW5jdGlvbiBnZXRDb21wdXRlZChlbGVtLHByb3ApIHtcclxuICByZXR1cm4gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtLG51bGwpLmdldFByb3BlcnR5VmFsdWUocHJvcCk7XHJcbn1cclxuIiwiZnVuY3Rpb24gcHVzaFRvSGlzdG9yeSgpIHtcclxuICB2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgaXRlbS50ZXh0Q29udGVudCA9IHNlYXJjaFRlcm0udmFsdWU7XHJcbiAgaWYoaGlzdG9yeS5jaGlsZHJlbi5sZW5ndGggPT09IDUpIHtcclxuICAgIGhpc3RvcnkucmVtb3ZlQ2hpbGQoaGlzdG9yeS5sYXN0RWxlbWVudENoaWxkKTtcclxuICB9XHJcbiAgaGlzdG9yeS5pbnNlcnRCZWZvcmUoaXRlbSxoaXN0b3J5LmZpcnN0RWxlbWVudENoaWxkKTtcclxuICB1cGRhdGVMb2NhbFN0b3JhZ2UoKTtcclxufVxyXG5cclxuaGlzdG9yeS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICBpZihlLnRhcmdldC50YWdOYW1lID09PSAnTEknKSB7XHJcbiAgICBzZWFyY2hUZXJtLnZhbHVlID0gZS50YXJnZXQuaW5uZXJUZXh0O1xyXG4gICAgY291bnQgPSAwO1xyXG4gICAgcHVzaFRvSGlzdG9yeSgpO1xyXG4gICAgZ2V0RGF0YSgpO1xyXG4gIH1cclxufSwgZmFsc2UpO1xyXG4iLCJmdW5jdGlvbiBzZXRTdG9yYWdlKGtleSx2YWx1ZSkge1xyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xyXG59XHJcbmZ1bmN0aW9uIGdldFN0b3JhZ2Uoa2V5LHZhbHVlKSB7XHJcbiAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5LCB2YWx1ZSk7XHJcbn1cclxuZnVuY3Rpb24gc2V0dXBTdG9yYWdlKCkge1xyXG4gIHZhciBzdG9yYWdlSXRlbSwgcmVjZW50SXRlbXMgPSAnJztcclxuICBpZighbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2lzVGlsZVZpZXcnKSkge1xyXG4gICAgLy8gbm8gbG9jYWwgc3RvcmFnZSB5ZXQgLSBzbyBzZXQgaXQgdXBcclxuICAgIHNldFN0b3JhZ2UoJ2lzVGlsZVZpZXcnLCdmYWxzZScpO1xyXG4gICAgaXNUaWxlVmlldyA9IGZhbHNlOyAvL2xpc3QgdmlldyBieSBkZWZhdWx0XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgaWYobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2lzVGlsZVZpZXcnKSA9PT0gJ3RydWUnKSB7XHJcbiAgICAgIG1haW4uY2xhc3NMaXN0LmFkZCgndGlsZScpO1xyXG4gICAgICBpc1RpbGVWaWV3ID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBpc1RpbGVWaWV3ID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmb3IodmFyIGk9MDtpPDU7aSsrKSB7XHJcbiAgICAgIHN0b3JhZ2VJdGVtID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlY2VudCcgKyBpKTtcclxuICAgICAgaWYoc3RvcmFnZUl0ZW0pIHtcclxuICAgICAgICByZWNlbnRJdGVtcyArPSAnPGxpPicgKyBzdG9yYWdlSXRlbTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHsgYnJlYWs7IH1cclxuICAgIH1cclxuICAgIGhpc3RvcnkuaW5uZXJIVE1MID0gcmVjZW50SXRlbXM7XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIHVwZGF0ZUxvY2FsU3RvcmFnZSgpIHtcclxuICB2YXIgc2VhcmNoZXMgPSBoaXN0b3J5LmNoaWxkcmVuO1xyXG4gIGZvcih2YXIgaT0wO2k8c2VhcmNoZXMubGVuZ3RoO2krKykge1xyXG4gICAgc2V0U3RvcmFnZSgncmVjZW50JyArIGksc2VhcmNoZXNbaV0udGV4dENvbnRlbnQpO1xyXG4gIH1cclxufVxyXG5zZXR1cFN0b3JhZ2UoKTtcclxuIiwiZnVuY3Rpb24gY3JlYXRlSXRlbUNsb25lKGl0ZW0pIHtcclxuICBjb25zb2xlLmxvZygnY2xvbmluZy4uLicsaXRlbSk7XHJcbiAgdmFyIGl0ZW1DbG9uZSA9IGl0ZW0uY2xvbmVOb2RlKHRydWUpO1xyXG4gIGl0ZW1DbG9uZS5jbGFzc0xpc3QuYWRkKCdjbG9uZScpO1xyXG4gIC8vY29uc29sZS5sb2coaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0LGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wKTtcclxuICBpdGVtQ2xvbmUuc3R5bGUubGVmdCA9IGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCArICdweCc7XHJcbiAgaXRlbUNsb25lLnN0eWxlLnRvcCA9IGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICsgJ3B4JztcclxuICByZXN1bHRzLmFwcGVuZENoaWxkKGl0ZW1DbG9uZSk7XHJcbiAgYW5pbWF0ZUl0ZW0oaXRlbUNsb25lKTtcclxuICBhcnR3b3JrLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gIHNob3dBcnR3b3JrKCk7XHJcbiAgcmVtb3ZlQ2xvbmUoaXRlbUNsb25lKTtcclxufVxyXG5mdW5jdGlvbiByZW1vdmVDbG9uZShjbG9uZSkge1xyXG4gIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICByZXN1bHRzLnJlbW92ZUNoaWxkKGNsb25lKTtcclxuICB9LCA3MDApO1xyXG59XHJcbmZ1bmN0aW9uIHNob3dBcnR3b3JrKCkge1xyXG4gIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICBhcnR3b3JrLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcclxuICB9LCA1MDApO1xyXG59XHJcbmZ1bmN0aW9uIGFuaW1hdGVJdGVtKGl0ZW0pIHtcclxuICBjb25zb2xlLmxvZygnbW92aW5nLi4uJyxpdGVtKTtcclxuICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGRpZmZYID0gZ2V0Q2VudGVyQ29vcmRzKGFydHdvcmspLnggLSBnZXRDZW50ZXJDb29yZHMoaXRlbSkueDtcclxuICAgIHZhciBkaWZmWSA9IGdldENlbnRlckNvb3JkcyhhcnR3b3JrKS55IC0gZ2V0Q2VudGVyQ29vcmRzKGl0ZW0pLnk7XHJcbiAgICAvL2NvbnNvbGUubG9nKGRpZmZYLGRpZmZZKTtcclxuICAgIGl0ZW0uc3R5bGUubGVmdCA9IHBhcnNlSW50KGdldENvbXB1dGVkKGl0ZW0sJ2xlZnQnKSwgMTApICsgZGlmZlggKyAncHgnO1xyXG4gICAgaXRlbS5zdHlsZS50b3AgPSBwYXJzZUludChnZXRDb21wdXRlZChpdGVtLCd0b3AnKSwgMTApICsgZGlmZlkgKyAncHgnO1xyXG4gICAgaXRlbS5zdHlsZS5vcGFjaXR5ID0gMDtcclxuICAgIC8vYXJ0d29yay5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XHJcbiAgfSwgMCk7XHJcbn1cclxuZnVuY3Rpb24gcmVzZXRNZWRpYSgpIHtcclxuICBhdWRpby5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5aW5nJyk7XHJcbiAgYXVkaW8uc3JjID0gJyc7XHJcbiAgYXJ0d29yay5zcmMgPSAnJztcclxufVxyXG5cclxuYXJ0d29yay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gIGF1ZGlvLnBsYXkoKTtcclxuICBhdWRpby5jbGFzc0xpc3QuYWRkKCdwbGF5aW5nJyk7XHJcbn0sIGZhbHNlKTtcclxuIiwiZnVuY3Rpb24gZ2V0RGF0YSgpIHtcclxuICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxyXG4gIHJlcXVlc3RVUkwgPSBiYXNlVVJMICsgY2xpZW50SUQgKyAnJnRhZ19saXN0PScgKyBzZWFyY2hUZXJtLnZhbHVlO1xyXG4gIHJlcXVlc3Qub3BlbignR0VUJywgcmVxdWVzdFVSTCwgdHJ1ZSk7XHJcbiAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA+PSAyMDAgJiYgcmVxdWVzdC5zdGF0dXMgPCA0MDApIHtcclxuICAgICAgLy8gU3VjY2VzcyFcclxuICAgICAgZGF0YSA9IEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpLmZpbHRlcihcclxuICAgICAgICBmdW5jdGlvbihlbGVtKSB7XHJcbiAgICAgICAgICAvL3JldHVybiBlbGVtLmFydHdvcmtfdXJsICYmIGVsZW0uc3RyZWFtX3VybCAmJiBlbGVtLnRpdGxlLmluZGV4T2YoJ2F0JykgIT09IC0xO1xyXG4gICAgICAgICAgcmV0dXJuIGVsZW0uYXJ0d29ya191cmwgJiYgZWxlbS5zdHJlYW1fdXJsO1xyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdubyByZXN1bHRzIGZvdW5kIDogJysgZGF0YS5sZW5ndGgpO1xyXG4gICAgICBwb3B1bGF0ZVJlc3VsdHMoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFdlIHJlYWNoZWQgb3VyIHRhcmdldCBzZXJ2ZXIsIGJ1dCBpdCByZXR1cm5lZCBhbiBlcnJvclxyXG4gICAgICBjb25zb2xlLmxvZygnc2VydmVyIHJldHVybmVkIGVycm9yJyk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAvLyBUaGVyZSB3YXMgYSBjb25uZWN0aW9uIGVycm9yIG9mIHNvbWUgc29ydFxyXG4gICAgY29uc29sZS5sb2coJ3JlcXVlc3QgZXJyb3InKTtcclxuICB9O1xyXG4gIHJlcXVlc3Quc2VuZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwb3B1bGF0ZVJlc3VsdHMoKSB7XHJcbiAgdmFyIHJlc3VsdHMgPSBcIlwiLCByZXN1bHRPYmo7XHJcbiAgY3VycmVudFJlc3VsdHMgPSBbXTtcclxuICByZXNldE1lZGlhKCk7XHJcbiAgZW5hYmxlQnRucygpO1xyXG4gIGZvcih2YXIgaT1jb3VudDtpPGNvdW50KzY7aSsrKSB7XHJcbiAgICByZXN1bHRPYmogPSB7fTtcclxuICAgIHJlc3VsdHMgKz0gJzxsaT48ZmlndXJlPjxpbWcgc3JjPVwiJyArXHJcbiAgICAgIGRhdGFbaSAlIGRhdGEubGVuZ3RoXS5hcnR3b3JrX3VybCArXHJcbiAgICAgICdcIj48ZmlnY2FwdGlvbj4nICtcclxuICAgICAgZGF0YVtpICUgZGF0YS5sZW5ndGhdLnRpdGxlICtcclxuICAgICAgJzwvZmlnY2FwdGlvbj48L2xpPic7XHJcbiAgICByZXN1bHRPYmouaW1hZ2UgPSBkYXRhW2kgJSBkYXRhLmxlbmd0aF0uYXJ0d29ya191cmw7XHJcbiAgICByZXN1bHRPYmouYXVkaW8gPSBkYXRhW2kgJSBkYXRhLmxlbmd0aF0uc3RyZWFtX3VybDtcclxuICAgIGN1cnJlbnRSZXN1bHRzLnB1c2gocmVzdWx0T2JqKTtcclxuICB9XHJcbiAgcmVzdWx0TGlzdC5pbm5lckhUTUwgPSByZXN1bHRzO1xyXG4gIGNvbnNvbGUubG9nKGN1cnJlbnRSZXN1bHRzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW5hYmxlQnRucygpIHtcclxuICBuZXh0QnRuLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgbGlzdFZpZXdCdG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB0aWxlVmlld0J0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIGRpc2FibGVCdG5zKCkge1xyXG4gIG5leHRCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGxpc3RWaWV3QnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuICB0aWxlVmlld0J0bi5kaXNhYmxlZCA9IHRydWU7XHJcbn1cclxuc2VhcmNoQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgY291bnQgPSAwO1xyXG4gIHB1c2hUb0hpc3RvcnkoKTtcclxuICBnZXREYXRhKCk7XHJcbn0sIGZhbHNlKTtcclxuXHJcbm5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICBjb3VudCArPSA2O1xyXG4gIHBvcHVsYXRlUmVzdWx0cygpO1xyXG59LCBmYWxzZSk7XHJcblxyXG5saXN0Vmlld0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnNvbGUubG9nKCdsaXN0IGJ1dHRvbiBjbGlja2VkJyk7XHJcbiAgICBpZihpc1RpbGVWaWV3KSB7XHJcbiAgICAgIGlzVGlsZVZpZXcgPSBmYWxzZTtcclxuICAgICAgbWFpbi5jbGFzc0xpc3QucmVtb3ZlKCd0aWxlJyk7XHJcbiAgICAgIHNldFN0b3JhZ2UoJ2lzVGlsZVZpZXcnLCdmYWxzZScpO1xyXG4gICAgfVxyXG59LCBmYWxzZSk7XHJcblxyXG50aWxlVmlld0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnNvbGUubG9nKCd0aWxlIGJ1dHRvbiBjbGlja2VkJyk7XHJcbiAgaWYoIWlzVGlsZVZpZXcpIHtcclxuICAgIGlzVGlsZVZpZXcgPSB0cnVlO1xyXG4gICAgbWFpbi5jbGFzc0xpc3QuYWRkKCd0aWxlJyk7XHJcbiAgICBzZXRTdG9yYWdlKCdpc1RpbGVWaWV3JywndHJ1ZScpO1xyXG4gIH1cclxufSwgZmFsc2UpO1xyXG5cclxucmVzdWx0cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICBjb25zb2xlLmxvZygnZXZlbnQgb2JqZWN0ID0nLGUpO1xyXG4gIHZhciBsaXN0SXRlbSA9IGNsb3Nlc3QoZS50YXJnZXQsICdsaScpO1xyXG4gIGNvbnNvbGUubG9nKCdsaXN0SXRlbScsbGlzdEl0ZW0pO1xyXG4gIC8vaWYoZS50YXJnZXQudGFnTmFtZSA9PT0gJ0xJJykge1xyXG4gICAgdmFyIGluZGV4ID0gZ2V0SW5kZXgobGlzdEl0ZW0pO1xyXG4gICAgY29uc29sZS5sb2coaW5kZXgsY3VycmVudFJlc3VsdHNbaW5kZXhdKTtcclxuICAgIGFydHdvcmsuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xyXG4gICAgYXJ0d29yay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAvLyBJIG9ubHkgd2FudCBmYWRlLWluIHRyYW5zaXRpb25cclxuICAgIGFydHdvcmsuc3JjID0gY3VycmVudFJlc3VsdHNbaW5kZXhdLmltYWdlO1xyXG4gICAgYXVkaW8uc3JjID0gY3VycmVudFJlc3VsdHNbaW5kZXhdLmF1ZGlvICsgY2xpZW50SUQ7XHJcbiAgICBjcmVhdGVJdGVtQ2xvbmUobGlzdEl0ZW0pO1xyXG5cclxuICAvL31cclxufSwgZmFsc2UpO1xyXG5cclxuZGlzYWJsZUJ0bnMoKTtcclxuIl19\n"],"sourceRoot":"/source/"}